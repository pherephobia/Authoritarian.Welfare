v2x_polyarchy = mean(v2x_polyarchy, na.rm = T),
v2stfisccap = mean(v2stfisccap, na.rm = T)) -> check
coef(main_model)[1]
coef(main_model)[3]
coef(main_model)[4]
check[1, 1]
check
subset |>
dplyr::select(COWcode, year, e_civil_war, v2x_polyarchy, v2stfisccap) |> drop_na() |>
summarize(
v2x_polyarchy = mean(v2x_polyarchy, na.rm = T),
v2stfisccap = quantile(v2stfisccap, probs = c(0.1, 0.9), na.rm = T)) -> check
check
check[2, 1]
check[1, 2]
coef(main_model)[3]*1 + coef(main_model)[4]*check[1, 2]  -> low
check[2, 2]
coef(main_model)[3]*1 + coef(main_model)[4]*check[2, 2]  -> high
point <- data.frame(statecap = c(as.numeric(check[1, 2]), as.numeric(check[2, 2])),
Mean =c(as.numeric(low), as.numeric(high)) ,
id = c("0", "0"))
jk_full_final |>
ggplot(aes(x = statecap, y = Mean)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey20") +
geom_line(aes(color = id), linetype = "dashed", show.legend = F) +
geom_line(aes(y = lower, color = id), show.legend = F) +
geom_line(aes(y = upper, color = id), show.legend = F) +
geom_point(data = point, aes(statecap, Mean, fill = id),
shape = 21, size = 3, show.legend = F) +
scale_color_viridis_d() +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), expand = c(.05,.05)) +
scale_y_continuous(breaks = c(seq(0, 7, 1))) +
labs(x = NULL, y = "Estimated marginal effects") +
gghighlight::gghighlight(id %in% "0", use_direct_label = FALSE) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) -> ME_sim
ME_sim
subset |>
ggplot(aes(x = v2stfisccap, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-3, 3, 0.05)), lim = c(-3, 3), expand = c(.05,.05)) +
labs(x = "State Fiscal Capacity)", y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of mass-based coalitions on welfare universalism, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of the mass party organization index. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis. When the data for Vietnam is excluded, the moderate marginal effect becomes apparent.", 130, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0)) -> MPO_hist
library(patchwork)
library(ggExtra)
ME_sim + MPO_hist +
patchwork::plot_layout(
ncol = 1,
nrow = 2,
widths = 4,
heights = c(6.5, 1.5)
)
subset |>
ggplot(aes(x = v2stfisccap, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-3, 3, 1)), lim = c(-3, 3),
expand = c(.05,.05)) +
labs(x = "State Fiscal Capacity)", y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of mass-based coalitions on welfare universalism, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of the mass party organization index. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis. When the data for Vietnam is excluded, the moderate marginal effect becomes apparent.", 130, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0)) -> MPO_hist
library(patchwork)
library(ggExtra)
ME_sim + MPO_hist +
patchwork::plot_layout(
ncol = 1,
nrow = 2,
widths = 4,
heights = c(6.5, 1.5)
)
theme_set(theme_bw())
jk_full_final |>
ggplot(aes(x = statecap, y = Mean)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey20") +
geom_line(aes(color = id), linetype = "dashed", show.legend = F) +
geom_line(aes(y = lower, color = id), show.legend = F) +
geom_line(aes(y = upper, color = id), show.legend = F) +
geom_point(data = point, aes(statecap, Mean, fill = id),
shape = 21, size = 3, show.legend = F) +
scale_color_viridis_d() +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), expand = c(.05,.05)) +
scale_y_continuous(breaks = c(seq(0, 7, 1))) +
labs(x = NULL, y = "Estimated marginal effects") +
gghighlight::gghighlight(id %in% "0", use_direct_label = FALSE) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) -> ME_sim
subset |>
ggplot(aes(x = v2stfisccap, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-3, 3, 1)), lim = c(-3, 3),
expand = c(.05,.05)) +
labs(x = "State Fiscal Capacity)", y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of mass-based coalitions on welfare universalism, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of the mass party organization index. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis. When the data for Vietnam is excluded, the moderate marginal effect becomes apparent.", 130, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0)) -> MPO_hist
library(patchwork)
library(ggExtra)
ME_sim + MPO_hist +
patchwork::plot_layout(
ncol = 1,
nrow = 2,
widths = 4,
heights = c(6.5, 1.5)
)
subset |>
ggplot(aes(x = v2stfisccap, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-3, 3, 1)), lim = c(-3, 3),
expand = c(.05,.05)) +
labs(x = "State Fiscal Capacity)", y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of X on Y, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of Z. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis.", 130, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0)) -> MPO_hist
library(patchwork)
library(ggExtra)
ME_sim + MPO_hist +
patchwork::plot_layout(
ncol = 1,
nrow = 2,
widths = 4,
heights = c(6.5, 1.5)
)
(86.99 + 113.30)/2
tibble::tribble(
~final,
89.36428571,
94.05714286,
63.75714286,
96.35,
79,
93.50714286,
91.26428571,
101.1,
85.74285714,
93.95,
101.1857143,
90.85,
85.04285714,
91.62142857,
96.88571429,
91.25714286,
82.8,
88.1,
99.39285714,
93.75,
73.70714286,
95.96428571,
54.28571429,
70.46428571,
102.3571429,
88.45,
94.88571429,
95.10714286,
92.95,
87.78571429,
67.71428571,
90.03571429,
88.61428571,
98.95,
95.98571429,
94.59285714,
80.55,
75.4,
96.95714286,
97.07857143,
90.57142857,
82.76428571,
90.55,
81.2,
83.64285714,
94.32142857,
86.62142857,
96.56428571,
89.42857143,
99.29285714,
85.96428571,
99.02142857,
94.6,
99.26428571,
83.3,
83.74285714,
54.60714286,
90.20714286,
96.17857143,
87.02142857,
82.74285714,
53.42857143,
93.70714286,
89.34285714,
96.71428571
) -> final_grade
final_grade |>
mutate(Letter = )
51.9+15+25
51.9+15+25+3
baseline |>
dplyr::filter(vdem_regime %in% c(0, 1)) |>
ggplot(aes(x = l_massparty, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), lim = c(-5, 10), expand = c(.05,.05)) +
labs(x = expression('Mass Party Organization Index'[t-1]), y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of mass-based coalitions on welfare universalism, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of the mass party organization index. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis. Excluding Vietnam represents the marginal effect of mass-based coalitions and mass party organization statistically insignificant", 100, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0, size = 12)) -> MPO_hist
## Import Packages to use ------------------------------------------------------
# devtools::install_github("vdeminstitute/vdemdata")
pacman::p_load(ggplot2, grid, pBrackets, ezpickr, countrycode, reshape2,
tidyr, patchwork, plm, futurevisions, panelView, RColorBrewer,
ggrepel, extrafont, tidyverse)
jk_full4_final |>
ggplot(aes(x = MPO, y = Mean)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey20") +
geom_line(aes(color = id), linetype = "dashed", show.legend = F) +
geom_line(aes(y = lower, color = id), show.legend = F) +
geom_line(aes(y = upper, color = id), show.legend = F) +
geom_point(data = point, aes(MPO, Mean, fill = id),
shape = 21, size = 3, show.legend = F) +
scale_color_viridis_d() +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), expand = c(.05,.05)) +
scale_y_continuous(breaks = c(seq(0, 7, 1))) +
labs(x = NULL, y = "Estimated marginal effects") +
gghighlight::gghighlight(id %in% "0", use_direct_label = FALSE) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) -> ME_sim
load("~/Library/CloudStorage/Dropbox/Scholar/2_Graduates/2019_03_Fall/PER_R19_AutocraticWelfare/Authoritarian.Welfare/April1st.RData")
jk_full4_final |>
ggplot(aes(x = MPO, y = Mean)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey20") +
geom_line(aes(color = id), linetype = "dashed", show.legend = F) +
geom_line(aes(y = lower, color = id), show.legend = F) +
geom_line(aes(y = upper, color = id), show.legend = F) +
geom_point(data = point, aes(MPO, Mean, fill = id),
shape = 21, size = 3, show.legend = F) +
scale_color_viridis_d() +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), expand = c(.05,.05)) +
scale_y_continuous(breaks = c(seq(0, 7, 1))) +
labs(x = NULL, y = "Estimated marginal effects") +
gghighlight::gghighlight(id %in% "0", use_direct_label = FALSE) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) -> ME_sim
baseline |>
dplyr::filter(vdem_regime %in% c(0, 1)) |>
ggplot(aes(x = l_massparty, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), lim = c(-5, 10), expand = c(.05,.05)) +
labs(x = expression('Mass Party Organization Index'[t-1]), y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of mass-based coalitions on welfare universalism, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of the mass party organization index. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis. Excluding Vietnam represents the marginal effect of mass-based coalitions and mass party organization statistically insignificant", 100, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0, size = 12)) -> MPO_hist
library(patchwork)
library(ggExtra)
ME_sim + MPO_hist +
patchwork::plot_layout(
ncol = 1,
nrow = 2,
widths = 4,
heights = c(6.5, 1.5)
)
point <- data.frame(MPO = c(as.numeric(check[1, 1]), as.numeric(check[2, 1])),
Mean =c(as.numeric(low), as.numeric(high)) ,
id = c("0", "0"))
jk_full4_final |>
ggplot(aes(x = MPO, y = Mean)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey20") +
geom_line(aes(color = id), linetype = "dashed", show.legend = F) +
geom_line(aes(y = lower, color = id), show.legend = F) +
geom_line(aes(y = upper, color = id), show.legend = F) +
geom_point(data = point, aes(MPO, Mean, fill = id),
shape = 21, size = 3, show.legend = F) +
scale_color_viridis_d() +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), expand = c(.05,.05)) +
scale_y_continuous(breaks = c(seq(0, 7, 1))) +
labs(x = NULL, y = "Estimated marginal effects") +
gghighlight::gghighlight(id %in% "0", use_direct_label = FALSE) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) -> ME_sim
baseline |>
dplyr::filter(vdem_regime %in% c(0, 1)) |>
ggplot(aes(x = l_massparty, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), lim = c(-5, 10), expand = c(.05,.05)) +
labs(x = expression('Mass Party Organization Index'[t-1]), y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of mass-based coalitions on welfare universalism, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of the mass party organization index. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis. Excluding Vietnam represents the marginal effect of mass-based coalitions and mass party organization statistically insignificant", 100, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0, size = 12)) -> MPO_hist
library(patchwork)
library(ggExtra)
ME_sim + MPO_hist +
patchwork::plot_layout(
ncol = 1,
nrow = 2,
widths = 4,
heights = c(6.5, 1.5)
)
## Import Packages to use ------------------------------------------------------
# devtools::install_github("vdeminstitute/vdemdata")
pacman::p_load(ggplot2, grid, pBrackets, ezpickr, countrycode, reshape2,
tidyr, patchwork, plm, futurevisions, panelView, RColorBrewer,
ggrepel, extrafont, tidyverse)
## Set the plot theme
theme_clean <- function() {
theme_minimal(base_family = "Barlow Semi Condensed") +
theme(panel.grid.minor = element_blank(),
plot.title = element_text(face = "bold", color = "black"),
plot.subtitle = element_text(face = "bold", color = "black"),
axis.title = element_text(family = "Barlow Semi Condensed Medium", color = "black",
margin = margin(t = 10, b = 10), size = rel(2)),
axis.text = element_text(family = "Barlow Semi Condensed Medium", color = "black",
size = rel(1.8)),
legend.text = element_text(family = "Barlow Semi Condensed Medium", color = "black",
size = rel(1.8)),
strip.text = element_text(family = "Barlow Semi Condensed",
face = "bold", size = rel(2), hjust = 0,
color = "black"),
strip.background = element_rect(fill = "white", color = NA),
plot.caption = element_text(hjust = 0, color = "black"),
legend.position = "bottom")
}
baseline |>
dplyr::filter(vdem_regime %in% c(0, 1)) |>
dplyr::select(COWcode, universality, l_mass_coalition, l_massparty,
l_gdppc, l_gdpgrth, l_lnresource, l_civilwar, l_repression,
l_CSOconsult, l_CSOpart, l_hereditaryindex, l_militaryindex,
l_partyindex, l_personindex) |> drop_na() |>
summarize(
massparty = quantile(l_massparty, probs = c(0.1, 0.9), na.rm = T),
meanlngdppc = mean(log(l_gdppc + 1), na.rm = T),
meangdpgrth = mean(l_gdpgrth, na.rm = T),
meanresource = mean(l_lnresource, na.rm = T),
meancivilwar = median(l_civilwar, na.rm = T),
meanrepression = mean(l_repression, na.rm = T),
meancsocon = mean(l_CSOconsult, na.rm = T),
meancsopart = mean(l_CSOpart, na.rm = T),
meanhereditary = mean(l_hereditaryindex, na.rm = T),
meanmilitary = mean(l_militaryindex, na.rm = T),
meanparty = mean(l_partyindex, na.rm = T),
meanpersonal = mean(l_personindex, na.rm = T)
) -> check
coef(full_tfixed2)[1]*1 + coef(full_tfixed2)[14]*check[1, 1]  -> low
full_tfixed2
coef(full_tfixed2)[1]*1 + coef(full_tfixed2)[14]*check[1, 1]  -> low
check
check[1, 1]
full_tfixed2
coef(full_tfixed2)[1]*1
coef(full_tfixed2)[1]*1 + coef(full_tfixed2)[14]*check[1, 1]
coef(full_tfixed2)[14]*check[1, 1]
check[1, 1]
coef(full_tfixed2)[1]*1 + coef(full_tfixed2)[14]*as.numeric(check[1, 1])  -> low
low
as.numeric(check[1, 1])
coef(full_tfixed2)[14]
full_tfixed2
full_tfixed2
plm::plm(
universality ~ l_massparty + log(l_gdppc+1) + l_gdpgrth +
l_lnresource + l_civilwar + l_repression + l_CSOconsult + l_CSOpart +
#l_royal + l_party + l_mil +
l_hereditaryindex + l_militaryindex + l_partyindex + l_personindex +
as.factor(COWcode) + as.factor(year),
index = c("COWcode", "year"),
effect = "twoways",
data = baseline |>
#dplyr::filter(brm %in% "Autocracies (BRM)")
dplyr::filter(vdem_regime %in% c(0, 1)) |>
mutate(l_mass_coalition = as.numeric(l_mass_coalition))
) -> full_tfixed2
coef(full_tfixed2)[1]*1 + coef(full_tfixed2)[14]*as.numeric(check[1, 1])  -> low
coef(full_tfixed2)[1]*1 + coef(full_tfixed2)[14]*check[2, 1] -> high
coef(full_tfixed2)[14]
plm::plm(
universality ~ l_mass_coalition*l_massparty + log(l_gdppc+1) + l_gdpgrth +
l_lnresource + l_civilwar + l_repression + l_CSOconsult + l_CSOpart +
#l_royal + l_party + l_mil +
l_hereditaryindex + l_militaryindex + l_partyindex + l_personindex +
as.factor(COWcode) + as.factor(year),
index = c("COWcode", "year"),
effect = "twoways",
data = baseline |>
#dplyr::filter(brm %in% "Autocracies (BRM)")
dplyr::filter(vdem_regime %in% c(0, 1)) |>
mutate(l_mass_coalition = as.numeric(l_mass_coalition))
) -> full_tfixed4
coef(full_tfixed4)[14]
coef(full_tfixed2)[1]*1 + coef(full_tfixed4)[14]*as.numeric(check[1, 1])  -> low
coef(full_tfixed2)[1]*1 + coef(full_tfixed4)[14]*check[2, 1] -> high
point <- data.frame(MPO = c(as.numeric(check[1, 1]), as.numeric(check[2, 1])),
Mean =c(as.numeric(low), as.numeric(high)) ,
id = c("0", "0"))
jk_full4_final |>
ggplot(aes(x = MPO, y = Mean)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey20") +
geom_line(aes(color = id), linetype = "dashed", show.legend = F) +
geom_line(aes(y = lower, color = id), show.legend = F) +
geom_line(aes(y = upper, color = id), show.legend = F) +
geom_point(data = point, aes(MPO, Mean, fill = id),
shape = 21, size = 3, show.legend = F) +
scale_color_viridis_d() +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), expand = c(.05,.05)) +
scale_y_continuous(breaks = c(seq(0, 7, 1))) +
labs(x = NULL, y = "Estimated marginal effects") +
gghighlight::gghighlight(id %in% "0", use_direct_label = FALSE) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) -> ME_sim
baseline |>
dplyr::filter(vdem_regime %in% c(0, 1)) |>
ggplot(aes(x = l_massparty, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), lim = c(-5, 10), expand = c(.05,.05)) +
labs(x = expression('Mass Party Organization Index'[t-1]), y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of mass-based coalitions on welfare universalism, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of the mass party organization index. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis. Excluding Vietnam represents the marginal effect of mass-based coalitions and mass party organization statistically insignificant", 100, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0, size = 12)) -> MPO_hist
library(patchwork)
library(ggExtra)
ME_sim + MPO_hist +
patchwork::plot_layout(
ncol = 1,
nrow = 2,
widths = 4,
heights = c(6.5, 1.5)
)
coef(full_tfixed4)[1]*1 + coef(full_tfixed4)[14]*as.numeric(check[1, 1])  -> low
coef(full_tfixed4)[1]*1 + coef(full_tfixed4)[14]*check[2, 1] -> high
point <- data.frame(MPO = c(as.numeric(check[1, 1]), as.numeric(check[2, 1])),
Mean =c(as.numeric(low), as.numeric(high)) ,
id = c("0", "0"))
jk_full4_final |>
ggplot(aes(x = MPO, y = Mean)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey20") +
geom_line(aes(color = id), linetype = "dashed", show.legend = F) +
geom_line(aes(y = lower, color = id), show.legend = F) +
geom_line(aes(y = upper, color = id), show.legend = F) +
geom_point(data = point, aes(MPO, Mean, fill = id),
shape = 21, size = 3, show.legend = F) +
scale_color_viridis_d() +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), expand = c(.05,.05)) +
scale_y_continuous(breaks = c(seq(0, 7, 1))) +
labs(x = NULL, y = "Estimated marginal effects") +
gghighlight::gghighlight(id %in% "0", use_direct_label = FALSE) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) -> ME_sim
baseline |>
dplyr::filter(vdem_regime %in% c(0, 1)) |>
ggplot(aes(x = l_massparty, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), lim = c(-5, 10), expand = c(.05,.05)) +
labs(x = expression('Mass Party Organization Index'[t-1]), y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of mass-based coalitions on welfare universalism, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of the mass party organization index. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis. Excluding Vietnam represents the marginal effect of mass-based coalitions and mass party organization statistically insignificant", 100, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0, size = 12)) -> MPO_hist
library(patchwork)
library(ggExtra)
ME_sim + MPO_hist +
patchwork::plot_layout(
ncol = 1,
nrow = 2,
widths = 4,
heights = c(6.5, 1.5)
)
## Set the plot theme
theme_clean <- function() {
theme_minimal(base_family = "Barlow Semi Condensed") +
theme(panel.grid.minor = element_blank(),
plot.title = element_text(face = "bold", color = "black"),
plot.subtitle = element_text(face = "bold", color = "black"),
axis.title = element_text(family = "Barlow Semi Condensed Medium", color = "black",
margin = margin(t = 10, b = 10), size = rel(2)),
axis.text = element_text(family = "Barlow Semi Condensed Medium", color = "black",
size = rel(1.8)),
legend.text = element_text(family = "Barlow Semi Condensed Medium", color = "black",
size = rel(1.8)),
strip.text = element_text(family = "Barlow Semi Condensed",
face = "bold", size = rel(2), hjust = 0,
color = "black"),
strip.background = element_rect(fill = "white", color = NA),
plot.caption = element_text(hjust = 0, color = "black"),
legend.position = "bottom")
}
## For the fonts on ggplot axis labels
showtext::showtext_auto(T)
## Apply the theme_clean() to ggplot() in general
theme_set(theme_bw())
jk_full4_final |>
ggplot(aes(x = MPO, y = Mean)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "grey20") +
geom_line(aes(color = id), linetype = "dashed", show.legend = F) +
geom_line(aes(y = lower, color = id), show.legend = F) +
geom_line(aes(y = upper, color = id), show.legend = F) +
geom_point(data = point, aes(MPO, Mean, fill = id),
shape = 21, size = 3, show.legend = F) +
scale_color_viridis_d() +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), expand = c(.05,.05)) +
scale_y_continuous(breaks = c(seq(0, 7, 1))) +
labs(x = NULL, y = "Estimated marginal effects") +
gghighlight::gghighlight(id %in% "0", use_direct_label = FALSE) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) -> ME_sim
baseline |>
dplyr::filter(vdem_regime %in% c(0, 1)) |>
ggplot(aes(x = l_massparty, y = ..density..)) +
geom_histogram(color = "black", fill = "white") +
scale_x_continuous(breaks = c(seq(-5, 10, 1)), lim = c(-5, 10), expand = c(.05,.05)) +
labs(x = expression('Mass Party Organization Index'[t-1]), y = "Density",
caption = str_wrap("\nNote: The figure depicts the impact of mass-based coalitions on welfare universalism, with the main result from the full model highlighted in color. Each line plot is shown with 95% confidence intervals. The colored points represent the estimated marginal effects at the bottom and top ten percentiles of the mass party organization index. Grey lines represent the marginal effects of models using the jackknife method, with each model excluding one country from the analysis. Excluding Vietnam represents the marginal effect of mass-based coalitions and mass party organization statistically insignificant", 100, exdent = 10)) +
theme(plot.caption = element_text(hjust = 0, size = 12)) -> MPO_hist
library(patchwork)
library(ggExtra)
ME_sim + MPO_hist +
patchwork::plot_layout(
ncol = 1,
nrow = 2,
widths = 4,
heights = c(6.5, 1.5)
)
ggsave("Documents/2_Manuscript/2_Figures/Fig_me_jk.pdf",
width = 8, height = 6, dpi = 1600)
getwd()\
getwd()
