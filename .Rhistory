v2regimpgroup == 4L ~ "Civil servants",
v2regimpgroup == 9L ~ "Urban Working",
v2regimpgroup == 11L ~ "Rural Working",
v2regimpgroup == 10L ~ "Urban Middle",
v2regimpgroup == 12L ~ "Rural Middle",
v2regimpgroup == 0L ~ "The aristocracy",
v2regimpgroup == 13L ~ "A foreign govt or colonial",
v2regimpgroup == NA ~ NA_character_,
T ~ NA_character_
) %>%
parse_factor(., levels = c("Party elites",
"The military",
"The ethnic/racial groups",
"The religous groups",
"Agrarian elites",
"Local elites",
"Business elites",
"Civil servants",
"Urban Working",
"Rural Working",
"Urban Middle",
"Rural Middle","The aristocracy",
"A foreign govt or colonial"), include_na = F, ordered = T),
class_raw.nu = as.numeric(class_raw)
)
table(autocracies$class_raw)
autocracies <- autocracies %>% mutate(
class = case_when(
v2regimpgroup == 2L ~ "Party elites",
v2regimpgroup == 5L ~ "The military",
v2regimpgroup == 6L ~ "The ethnic/racial/religous groups",
v2regimpgroup == 7L ~ "The ethnic/racial/religous groups",
v2regimpgroup == 1L ~ "Agrarian/local elites",
v2regimpgroup == 8L ~ "Agrarian/local elites",
v2regimpgroup == 3L ~ "Business elites/civil servants",
v2regimpgroup == 4L ~ "Business elites/civil servants",
v2regimpgroup == 9L ~ "Urban Working",
v2regimpgroup == 11L ~ "Rural Working",
v2regimpgroup == 10L ~ "Urban Middle",
v2regimpgroup == 12L ~ "Rural Middle",
v2regimpgroup == 0L ~ "The aristocracy",
v2regimpgroup == 13L ~ "A foreign govt. or colonial power",
T ~ NA_character_
) %>%
parse_factor(., levels = c("Party elites",
"The military",
"The ethnic/racial/religous groups",
"Agrarian/local elites",
"Business elites/civil servants",
"Urban Working",
"Rural Working",
"Urban Middle",
"Rural Middle",
"The aristocracy",
"A foreign govt. or colonial power"),
include_na = F, ordered = T),
class.nu = as.numeric(class)
) %>% drop_na(class)
names(autocracies)
autocracies <- autocracies %>%
select(
country_name, ccode, year, e_lexical_index, v2x_polyarchy, regime,
v2xps_party, v2dlunivl, v2psprbrch, v2psprlnks, v2psorgs,
v2psplats, v2pscohesv, v2dlencmps, v2regimpgroup, v2regsupgroupssize,
class_raw, class_raw.nu,
class, class.nu, totalunivers, univers_oldageprog, univers_mater_prog,
univers_sick_prog, univers_working_prog, univers_unemp_prog,
univers_familiy_prog, resdep2, urban, cow_milsize, e_migdpgro, e_mipopula,
e_migdppc, e_miurbpop, e_miinteco, e_civil_war, v2regendtype, v2csantimv, everything())
allregime <- allregime %>% mutate(
class_raw = case_when(
v2regimpgroup == 2L ~ "Party elites",
v2regimpgroup == 5L ~ "The military",
v2regimpgroup == 6L ~ "The ethnic/racial groups",
v2regimpgroup == 7L ~ "The religous groups",
v2regimpgroup == 1L ~ "Agrarian elites",
v2regimpgroup == 8L ~ "Local elites",
v2regimpgroup == 3L ~ "Business elites",
v2regimpgroup == 4L ~ "Civil servants",
v2regimpgroup == 9L ~ "Urban Working",
v2regimpgroup == 11L ~ "Rural Working",
v2regimpgroup == 10L ~ "Urban Middle",
v2regimpgroup == 12L ~ "Rural Middle",
v2regimpgroup == 0L ~ "The aristocracy",
v2regimpgroup == 13L ~ "A foreign govt or colonial",
v2regimpgroup == NA ~ NA_character_,
T ~ NA_character_
) %>%
parse_factor(., levels = c("Party elites",
"The military",
"The ethnic/racial groups",
"The religous groups",
"Agrarian elites",
"Local elites",
"Business elites",
"Civil servants",
"Urban Working",
"Rural Working",
"Urban Middle",
"Rural Middle","The aristocracy",
"A foreign govt or colonial"), include_na = F, ordered = T),
class_raw.nu = as.numeric(class_raw)
)
table(autocracies$class_raw)
allregime <- allregime %>% mutate(
class = case_when(
v2regimpgroup == 2L ~ "Party elites",
v2regimpgroup == 5L ~ "The military",
v2regimpgroup == 6L ~ "The ethnic/racial/religous groups",
v2regimpgroup == 7L ~ "The ethnic/racial/religous groups",
v2regimpgroup == 1L ~ "Agrarian/local elites",
v2regimpgroup == 8L ~ "Agrarian/local elites",
v2regimpgroup == 3L ~ "Business elites/civil servants",
v2regimpgroup == 4L ~ "Business elites/civil servants",
v2regimpgroup == 9L ~ "Urban Working",
v2regimpgroup == 11L ~ "Rural Working",
v2regimpgroup == 10L ~ "Urban Middle",
v2regimpgroup == 12L ~ "Rural Middle",
v2regimpgroup == 0L ~ "The aristocracy",
v2regimpgroup == 13L ~ "A foreign govt. or colonial power",
T ~ NA_character_
) %>%
parse_factor(., levels = c("Party elites",
"The military",
"The ethnic/racial/religous groups",
"Agrarian/local elites",
"Business elites/civil servants",
"Urban Working",
"Rural Working",
"Urban Middle",
"Rural Middle",
"The aristocracy",
"A foreign govt. or colonial power"),
include_na = F, ordered = T),
class.nu = as.numeric(class)
) %>% drop_na(class)
allregime <- allregime %>%
select(
country_name, ccode, year, e_lexical_index, v2x_polyarchy, regime,
v2xps_party, v2dlunivl, v2psprbrch, v2psprlnks, v2psorgs,
v2psplats, v2pscohesv, v2dlencmps, v2regimpgroup, v2regsupgroupssize,
class_raw, class_raw.nu,
class, class.nu, totalunivers, univers_oldageprog, univers_mater_prog,
univers_sick_prog, univers_working_prog, univers_unemp_prog,
univers_familiy_prog, resdep2, urban, cow_milsize, e_migdpgro, e_mipopula,
e_migdppc, e_miurbpop, e_miinteco, e_civil_war, everything())
class <-  c("Party elites", "The military", "Agrarian/local elites",
"Urban Working", "Urban Middle")
names(autocracies)
class_summary <- autocracies %>%
select(class, totalunivers, v2regsupgroupssize, v2dlunivl, year) %>%
dplyr::filter(class %in% c("Party elites", "The military",
"Urban Working", "Urban Middle") &
year > 1916) %>%
group_by(class) %>%
summarise(mean.w1 = mean(totalunivers, na.rm = T),
sd.w1 = sd(totalunivers, na.rm = T),
lower.w1 = mean(totalunivers, na.rm = T) - sd(totalunivers, na.rm = T),
upper.w1 = mean(totalunivers, na.rm = T) + sd(totalunivers, na.rm = T),
mean.w2 = mean(v2dlunivl, na.rm = T),
sd.w2 = sd(v2dlunivl, na.rm = T),
lower.w2 = mean(v2dlunivl, na.rm = T) - sd(v2dlunivl, na.rm = T),
upper.w2 = mean(v2dlunivl, na.rm = T) + sd(v2dlunivl, na.rm = T))
summary.w <- autocracies %>% dplyr::filter(year > 1916) %>%
group_by(class) %>%
summarise(mean.w1 = mean(totalunivers, na.rm = T),
mean.w2 = mean(v2dlunivl, na.rm = T),
mean.size = mean(v2regsupgroupssize, na.rm = T))
autocracies %>%
dplyr::filter(class %in% c("Party elites", "The military",
"Urban Working", "Urban Middle") & year > 1916) %>%
ggplot(aes(x = totalunivers)) +
geom_density(aes(x = totalunivers, fill = class),
alpha = 0.2, size = 0.2, show.legend = F) +
facet_wrap(~as.factor(class)) +
geom_vline(data=filter(summary.w, class=="Party elites"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="Party elites"),
map = aes(x = mean.w1 + 2, y = 0.05), size = 3,
label = "Mean U.I. = 17.5") +
geom_vline(data=filter(summary.w, class=="The military"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="The military"),
map = aes(x = mean.w1 + 5, y = 0.05), size = 3,
label = "Mean U.I. = 14.7") +
geom_vline(data=filter(summary.w, class=="Urban Working"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="Urban Working"),
map = aes(x = mean.w1 + 2, y = 0.05), size = 3,
label = "Mean U.I. = 19.0") +
geom_vline(data=filter(summary.w, class=="Urban Middle"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="Urban Middle"),
map = aes(x = mean.w1 + 2, y = 0.05), size = 3,
label = "Mean U.I. = 23.5") +
#  scale_fill_manual(values = wes_palette("IsleofDogs1")) +
labs(x = "Universalism Index of SPaW",
y = "Density") +
#  facet_wrap(~class, ncol = 2) +
theme(
element_text(family = "Helvetica"),
legend.title = element_blank(),
legend.position = "bottom",
plot.margin = margin(0.2, 0.2, 0.2, 0.2, "cm"),
axis.title.x = element_text(
margin = margin(t = 25, b = 10)),
axis.title.y = element_text(
margin = margin(r = 5, l = 5))
)
print(Figure2_1)
autocracies %>%
dplyr::filter(class %in% c("Party elites", "The military",
"Urban Working", "Urban Middle") & year > 1916) %>%
ggplot(aes(x = totalunivers)) +
geom_density(aes(x = totalunivers, fill = class),
alpha = 0.2, size = 0.2, show.legend = F) +
facet_wrap(~as.factor(class)) +
geom_vline(data=filter(summary.w, class=="Party elites"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="Party elites"),
map = aes(x = mean.w1 + 2, y = 0.05), size = 3,
label = "Mean U.I. = 17.5") +
geom_vline(data=filter(summary.w, class=="The military"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="The military"),
map = aes(x = mean.w1 + 5, y = 0.05), size = 3,
label = "Mean U.I. = 14.7") +
geom_vline(data=filter(summary.w, class=="Urban Working"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="Urban Working"),
map = aes(x = mean.w1 + 2, y = 0.05), size = 3,
label = "Mean U.I. = 19.0") +
geom_vline(data=filter(summary.w, class=="Urban Middle"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="Urban Middle"),
map = aes(x = mean.w1 + 2, y = 0.05), size = 3,
label = "Mean U.I. = 23.5") +
#  scale_fill_manual(values = wes_palette("IsleofDogs1")) +
labs(x = "Universalism Index of SPaW",
y = "Density") +
#  facet_wrap(~class, ncol = 2) +
theme(
element_text(family = "Helvetica"),
legend.title = element_blank(),
legend.position = "bottom",
plot.margin = margin(0.2, 0.2, 0.2, 0.2, "cm"),
axis.title.x = element_text(
margin = margin(t = 25, b = 10)),
axis.title.y = element_text(
margin = margin(r = 5, l = 5))
)
class <-  c("Party elites", "The military", "Agrarian/local elites",
"Urban Working", "Urban Middle")
class_summary <- autocracies %>%
select(class, totalunivers, v2regsupgroupssize, v2dlunivl, year) %>%
dplyr::filter(class %in% c("Party elites", "The military",
"Urban Working", "Urban Middle") &
year > 1916) %>%
group_by(class) %>%
summarise(mean.w1 = mean(totalunivers, na.rm = T),
sd.w1 = sd(totalunivers, na.rm = T),
lower.w1 = mean(totalunivers, na.rm = T) - sd(totalunivers, na.rm = T),
upper.w1 = mean(totalunivers, na.rm = T) + sd(totalunivers, na.rm = T),
mean.w2 = mean(v2dlunivl, na.rm = T),
sd.w2 = sd(v2dlunivl, na.rm = T),
lower.w2 = mean(v2dlunivl, na.rm = T) - sd(v2dlunivl, na.rm = T),
upper.w2 = mean(v2dlunivl, na.rm = T) + sd(v2dlunivl, na.rm = T))
summary.w <- autocracies %>% dplyr::filter(year > 1916) %>%
group_by(class) %>%
summarise(mean.w1 = mean(totalunivers, na.rm = T),
mean.w2 = mean(v2dlunivl, na.rm = T),
mean.size = mean(v2regsupgroupssize, na.rm = T))
autocracies %>%
dplyr::filter(class %in% c("Party elites", "The military",
"Urban Working", "Urban Middle") & year > 1916) %>%
ggplot(aes(x = totalunivers)) +
geom_density(aes(x = totalunivers, fill = class),
alpha = 0.2, size = 0.2, show.legend = F) +
facet_wrap(~as.factor(class)) +
geom_vline(data=filter(summary.w, class=="Party elites"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="Party elites"),
map = aes(x = mean.w1 + 2, y = 0.05), size = 3,
label = "Mean U.I. = 17.5") +
geom_vline(data=filter(summary.w, class=="The military"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="The military"),
map = aes(x = mean.w1 + 5, y = 0.05), size = 3,
label = "Mean U.I. = 14.7") +
geom_vline(data=filter(summary.w, class=="Urban Working"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="Urban Working"),
map = aes(x = mean.w1 + 2, y = 0.05), size = 3,
label = "Mean U.I. = 19.0") +
geom_vline(data=filter(summary.w, class=="Urban Middle"),
aes(xintercept=mean.w1), colour="black") +
geom_text(
data    = filter(summary.w, class=="Urban Middle"),
map = aes(x = mean.w1 + 2, y = 0.05), size = 3,
label = "Mean U.I. = 23.5") +
#  scale_fill_manual(values = wes_palette("IsleofDogs1")) +
labs(x = "Universalism Index of SPaW",
y = "Density") +
#  facet_wrap(~class, ncol = 2) +
theme(
element_text(family = "Helvetica"),
legend.title = element_blank(),
legend.position = "bottom",
plot.margin = margin(0.2, 0.2, 0.2, 0.2, "cm"),
axis.title.x = element_text(
margin = margin(t = 25, b = 10)),
axis.title.y = element_text(
margin = margin(r = 5, l = 5))
)
#############################################################
##### Coefplot for Table 1
#############################################################
library(ezpickr)
table1 <- pick("Analysis_Data/table1.dta")
library(tidyverse)
table1 <- table1 %>% dplyr::filter(!str_detect(var, ".ccode"))
table1 <- table1 %>%
dplyr::filter(!var %in% c("ww1", "ww2", "coldwar", "_cons")) %>%
rowid_to_column() %>%
mutate(
insig = ifelse(ci_lower < 0 & ci_upper > 0, 1, 0),
model = case_when(
rowid > 28 & rowid < 35 ~ "T1M1",
rowid > 24 & rowid < 29 ~ "T1M3",
rowid > 17 & rowid < 25 ~ "T1M5",
rowid > 11 & rowid < 18 ~ "T1M2",
rowid > 7 & rowid < 12 ~ "T1M4",
rowid > 0 & rowid < 8 ~ "T1M6"))
table1_spaw <- table1 %>%
dplyr::filter(var %in% c("party", "military", "urban_working", "lag3pi") &
model %in% c("T1M1", "T1M3", "T1M5"))
table1_vdem <- table1 %>%
dplyr::filter(var %in% c("party", "military", "urban_working", "lag3pi") &
model %in% c("T1M2", "T1M4", "T1M6"))
table1_spaw <- table1_spaw %>%
mutate(
model = model %>%
parse_factor(., levels = c("T1M1", "T1M3", "T1M5"),
ordered = T, include_na = F),
var = var %>% parse_factor(., c("urban_working", "party", "military", "lag3pi"),
include_na = F, ordered = T),
insig = ifelse(ci_lower < 0 & ci_upper > 0, 0, 1)
)
table(table1_spaw$var)
labels.spaw <- c(T1M1 = "Model 1", T1M5 = "Model 3", T1M3 = "Model 2")
spaw <- table1_spaw %>%
ggplot(aes(x = var, y = coef, color=as.factor(insig))) +
geom_point(position = position_dodge(width = 0.9), show.legend = F) +
geom_line(show.legend = F, position = position_dodge(width = 0.9)) +
geom_pointrange(aes(ymin = ci_lower, ymax = ci_upper),
position = position_dodge(width = 0.9),
show.legend = F) +
geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
scale_x_discrete(label = c("Urban\nWorking", "Party\nElites",
"Military", "Party\nInst.")) +
scale_color_manual(values = wes_palette("Royal1")) +
labs(x = "",
y = "Estimates",
title = "") +
facet_wrap(~model, ncol = 3, labeller=labeller(model = labels.spaw)) +
theme_bw() + theme(legend.position = "bottom",
plot.title = element_text(size = 10))
print(spaw)
interaction <- pick("Analysis_Data/intclasspi.dta")
interaction$var
table6 <- interaction %>% dplyr::filter(!str_detect(var, ".ccode"))
interaction <- interaction %>%
dplyr::filter(!var %in% c("ww1", "ww2", "coldwar", "_cons")) %>%
mutate(
insig = ifelse(ci_lower < 0 & ci_upper > 0, 0, 1)
)
install.packages("panelAR")
install.packages("rlang")
install.packages("rlang")
re.sample <- pick("Data/urban_working.dta")
re.sample <- pick("Analysis_Data/urban_working.dta")
data <- re.sample %>%
select(totalunivers, ccode, year, ww1, ww2, coldwar, party, military,
urban_working, urban_middle,
lag3pi, lag3gdp, lag3pop, lag3resdep, dum_3, dum_4,
dum_5, dum_7, dum_9, dum_10, dum_11) %>%
dplyr::filter((dum_3==0 | dum_4==0 | dum_5==0 |
dum_7==0 | dum_9==0 | dum_10==0 | dum_11 == 0) &
(year > 1915)) %>% data.frame()
drop_na(data)
data <- drop_na(data)
library(panelAR)
summary(results)
results <- panelAR(formula = totalunivers ~ as.factor(ccode) +
ww1 + ww2 + coldwar + party + military + urban_working + lag3pi +
I(urban_working*lag3pi) + lag3gdp + lag3pop + lag3resdep,
data = data, panelVar = "ccode", timeVar = "year",
panelCorrMethod = "pcse", autoCorr = "psar1", complete.case = F,
rho.na.rm = T, singular.ok = T)
results$terms
results$coefficients
se <- sqrt(diag(results$vcov))
1- pnorm(3.00292408/1.449234296)
summary.panelAR(results)
beta_draws <- rmvnorm(n=100000, mean = coef(results), sigma=vcov(results)) #Parametric Bootstrapping
library(mvtnorm)
beta_draws <- rmvnorm(n=100000, mean = coef(results), sigma=vcov(results)) #Parametric Bootstrapping
beta_draw_s <- beta_draws[, -c(2:82)]
beta_draw_s[1,]
pi_grid <- seq(0, 1, by=0.01)
rownames(beta_draws)
v <- colnames(beta_draws)
dim(beta_draws)
dim(beta_draws)
noworking <- cbind(1, 0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
.0205034, .0249208, .2872979, .1951177, .2465468, 0, pi_grid, 0, 7.906028, 8.534317, 4.589921)
working <- cbind(1, 0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,
0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632,0.01052632
, .0205034, .0249208, .2872979, .1951177, .2465468, 1, pi_grid, pi_grid, 7.906028, 8.534317, 4.589921)
dim(beta_draws)
dim(noworking)
dim(working)
NW <- t(noworking %*% t(beta_draws))
NW.m <- apply(NW, 2, mean)
NW.se <- apply(NW, 2, quantile, c(0.025, 0.975))
W <- t(working %*% t(beta_draws))
W.m <- apply(W, 2, mean)
W.se <- apply(W, 2, quantile, c(0.025, 0.975))
W.data <- data.frame(ID = "Urban working",
Class = "Urban working",
PI=pi_grid,
Mean=W.m,
Lower=W.se[1,],
Upper=W.se[2,])
Data <- rbind(NW.data, W.data) %>% as_tibble()
NW.data <- data.frame(ID = "No-Urban working",
Class = "No-Urban working",
PI=pi_grid,
Mean=NW.m,
Lower=NW.se[1,],
Upper=NW.se[2,])
library(wesanderson)
library(tidyverse)
Data %>%
ggplot(aes(x=PI, y=Mean, color=ID)) +
geom_ribbon(aes(y = Mean, ymin = Lower, ymax = Upper, fill= ID),
show.legend = F, alpha = 0.2) +
geom_line() +
#geom_point(position = position_dodge(0.1)) +
#geom_pointrange(aes(y = Mean, ymin = Lower, ymax = Upper),
#                position = position_dodge(0.1))+
#facet_wrap(~ID) +
labs(y="Predicted Universal Welfare", x="Party Institutionaliztion") +
scale_x_continuous(breaks = c(seq(from = 0.0, to = 1.0, by = 0.1))) +
theme_bw() +
theme(legend.position = "bottom",
legend.title = element_blank()) +
scale_color_manual(values = wes_palette(n = 2, name = "BottleRocket1")) +
scale_fill_manual(values = wes_palette(n = 2, name = "BottleRocket1")) +
#  scale_color_viridis(discrete=TRUE, option="plasma") +
#  scale_fill_viridis(discrete=TRUE, option="plasma") +
#  scale_color_brewer(palette = "PuOr") +
#scale_fill_brewer(palette = "PuOr") +
guides(col = guide_legend(nrow = 1))
Data <- rbind(NW.data, W.data) %>% as_tibble()
Data %>%
ggplot(aes(x=PI, y=Mean, color=ID)) +
geom_ribbon(aes(y = Mean, ymin = Lower, ymax = Upper, fill= ID),
show.legend = F, alpha = 0.2) +
geom_line() +
#geom_point(position = position_dodge(0.1)) +
#geom_pointrange(aes(y = Mean, ymin = Lower, ymax = Upper),
#                position = position_dodge(0.1))+
#facet_wrap(~ID) +
labs(y="Predicted Universal Welfare", x="Party Institutionaliztion") +
scale_x_continuous(breaks = c(seq(from = 0.0, to = 1.0, by = 0.1))) +
theme_bw() +
theme(legend.position = "bottom",
legend.title = element_blank()) +
scale_color_manual(values = wes_palette(n = 2, name = "BottleRocket1")) +
scale_fill_manual(values = wes_palette(n = 2, name = "BottleRocket1")) +
#  scale_color_viridis(discrete=TRUE, option="plasma") +
#  scale_fill_viridis(discrete=TRUE, option="plasma") +
#  scale_color_brewer(palette = "PuOr") +
#scale_fill_brewer(palette = "PuOr") +
guides(col = guide_legend(nrow = 1))
